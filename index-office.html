<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inventory Management ‚Äì Seavo Nautiq</title>
  <style>
    body {
      background-color: #12315c;
      font-family: Arial, sans-serif;
      margin: 0;
      color: rgb(255, 255, 255);
    }

    .category-slider {
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(to right, #041425, #3b7fbe);
      padding: 30px;
      overflow-x: auto;
    }

    .category-item {
      display: flex;
      align-items: center;
      margin: 0 6px;
    }

    .category-button, .add-category {
      padding: 10px 30px;
      background: linear-gradient(to right, #00b7ff, #326fa8);
      color: rgb(255, 255, 255);
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;  
    }

    .category-button.active {
      background: #9ccdfa;
      font-weight: bold;
    }
    
    .category-button:hover, .add-category:hover {
      background: #56bafd;
      color: white;
    }

    .delete-category {
      color: rgb(255, 0, 0);
      font-size:20px;
      margin-left: 20px;
      cursor: pointer;
    }

    .arrow {
      font-size: 20px;
      font-weight: bold;
      padding: 5px 10px;
      background: transparent;
      color: rgb(255, 255, 255);
      border-radius: 6px;
      cursor: pointer;
      width: 60px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.6);
    }

    #content {
      padding: 60px;
    }

    .logo {
      width: 200px;
      height: 40px;
      display:  block;
      margin: 0 auto;
      margin-bottom: -30px;
      border-radius: 6px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.6);
      margin-top: 30px;
    }

    #searchBox {
      width: 200px;
      padding: 10px;
      border-radius: 6px;
      border:  1px solid #000000;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.6);
      margin-left: 60px;
      font-weight: bold;
      

    }


    table { 
      width: 100%;
      border-collapse: collapse;
      background-color: rgb(40, 72, 121);
      color: rgb(0, 0, 0);
      margin-bottom: 20px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.6);
    }


    .large-bold-input {
      font-weight: bold;
      font-size: 16px;
    }

    .cell-min {
      width: 45px;
    }

    .cell-order {
      width: 40px;
    }



    th, td {
      border: 1px solid #1f3c68;
      padding: 8px;
      text-align: center;
      font-size: 18px;
    }

    th {
      background-color:  #13a2e4;
      color: rgb(0, 0, 0);
      border-radius: 5px;
    }

    td.min-col input {
      width: 60px;
    }

    .red-warning {
      background: linear-gradient(to right, #ffffff, #ff9f31);
    }

    .add-line {
      padding: 8px 16px;
      margin: 5px 10px 20px 0;
      font-size: 15px;
      font-weight: bold;
      border-radius: 10px;
      background: linear-gradient(to right, #00b7ff, #326fa8);
      cursor: pointer;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.6);
    }

    .header-row td {
      background: linear-gradient(to left, #12315c, #79acee);
      font-weight: bold;;
      text-align: left;
      border-radius: 5px;
      border-color: black;
    }

    .header-row td span {
      display: inline-block;
      width: 100%;
    }

    .delete-button {
      color: rgb(0, 0, 0);
      cursor: pointer;
      font-size: 20px;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.9);
    }

    .delete-button:hover {
      background-color: rgba(0, 0, 0, 0.3); 
      border-radius: 50px; 
      padding:0px 5px;
    }

    td:last-child {
      width: 50px; 
      background: linear-gradient(to right, #4e9bce, #1b3863);
    }


      button img {
      width: 40px;
      height: 40px;
      padding-left: 55px;
      margin-top: 20px;
    }


    .global-button {
      background: linear-gradient(to right, #00b7ff, #326fa8);
      color: rgb(255, 255, 255);
      padding: 20px 15px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px 60px;
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.6);
    }


    .cell-product {
  width: 200px;
}

.cell-comment {
  width: 240px;
}

.cell-small {
  width: 80px;
}


  
  </style>
</head>


<body>

  

<div class="category-slider">
  <button class="arrow" onclick="scrollSlider(-100)">‚Üê</button>
  <div id="category-container" style="display: flex; overflow-x: auto; max-width: 70%; scroll-behavior: smooth;">
    <div id="categories" style="display: flex; gap: 8px;"></div>
  </div>
  <button class="arrow" onclick="scrollSlider(100)">‚Üí</button>
  <button class="add-category" onclick="addCategory()">+ Category</button>
</div>

<div>
  <img src="images/Seavo nautiq logo.png" alt="logo" class="logo">

  <input type="text" id="searchBox" placeholder="Search inventory..." oninput="searchInPage()">

<style>
.highlight {
  background-color: rgb(52, 131, 221);
  font-weight: bold;
}

.highlight-input {
  background-color: rgb(241, 241, 31);
  font-weight: bold;
}
</style>


</div>


<div id="content"></div>


<button class="global-button" onclick="showGlobalOverview()">üìã Global Overview</button>

<div>
  <button style="background-color: transparent; border: none; padding: 0;">

    <img src="icon/Paper-clip.png" alt="" style="background-color: transparent;">
    <img src="icon/Share.png" alt="" style="background-color: transparent;">
    <img src="icon/Doc.png" alt="" style="background-color: transparent;">
</button>
</div>


<script>
function searchInPage() {
  const term = document.getElementById("searchBox").value.trim().toLowerCase();
  removeHighlights();
  if (term === "") return;

  let firstMatch = null;

  // 1. S√∏k i headers (span-elementer)
  document.querySelectorAll("td span").forEach(span => {
    const content = span.textContent.toLowerCase();
    if (content.includes(term)) {
      const index = content.indexOf(term);
      const original = span.textContent;
      const before = original.slice(0, index);
      const match = original.slice(index, index + term.length);
      const after = original.slice(index + term.length);
      span.innerHTML = `${before}<span class="highlight">${match}</span>${after}`;
      if (!firstMatch) firstMatch = span;
    }
  });

  // 2. S√∏k i input-feltene
  document.querySelectorAll("input").forEach(input => {
    if (input.value.toLowerCase().includes(term)) {
      input.classList.add("highlight-input");
      if (!firstMatch) firstMatch = input;
    }
  });

  // Scroll til f√∏rste treff
  if (firstMatch) {
    setTimeout(() => {
      firstMatch.scrollIntoView({ behavior: "smooth", block: "center" });
    }, 100); // vent litt s√• tabellen rekker √• tegne seg
  }
}

function removeHighlights() {
  // Fjern <span class="highlight"> fra header
  document.querySelectorAll("span .highlight").forEach(el => {
    const parent = el.parentNode;
    parent.replaceChild(document.createTextNode(el.textContent), el);
    parent.normalize();
  });

  // Fjern gul markering fra input
  document.querySelectorAll(".highlight-input").forEach(input => {
    input.classList.remove("highlight-input");
  });
}


</script>




<script>
let data = JSON.parse(localStorage.getItem("lagerDataV3")) || {};
let activeCategory = Object.keys(data)[0] || "Standard";

function save() {
  localStorage.setItem("lagerDataV3", JSON.stringify(data));
}

function scrollSlider(offset) {
  document.getElementById("category-container").scrollLeft += offset;
}

function updateCategories() {
  const container = document.getElementById("categories");
  container.innerHTML = "";

  Object.keys(data).forEach(name => {
    const wrapper = document.createElement("div");
    wrapper.className = "category-item";
    wrapper.style.display = "flex";
    wrapper.style.alignItems = "center";

    const btn = document.createElement("button");
    btn.className = "category-button";
    btn.textContent = name;
    if (name === activeCategory) btn.classList.add("active");
    btn.onclick = () => {
      activeCategory = name;
      showCategory();
      updateCategories();
    };

    const del = document.createElement("span");
    del.className = "delete-category";
    del.textContent = "üóëÔ∏è";
    del.onclick = () => {
      if (confirm(`Do you want to delete the category "${name}"?`)) {
        delete data[name];
        activeCategory = Object.keys(data)[0] || null;
        save();
        updateCategories();
        showCategory();
      }
    };

    wrapper.appendChild(btn);
    wrapper.appendChild(del);
    container.appendChild(wrapper);
  });
}

function addCategory() {
  const name = prompt("New category:");
  if (name && !data[name]) {
    data[name] = [];
    activeCategory = name;
    save();
    updateCategories();
    showCategory();
  }
}

function showCategory() {
  const content = document.getElementById("content");
  content.innerHTML = "";

  if (!activeCategory || !data[activeCategory]) return;

  const table = document.createElement("table");
  table.innerHTML = `
    <thead>
      <tr>
        <th>Product/Type</th><th>Start Qty</th><th>Used</th><th>End Qty</th>
        <th>MIN</th><th>Comments</th><th>Order</th><th>Delete</th>
      </tr>
    </thead>
    <tbody></tbody>
  `;
  const tbody = table.querySelector("tbody");

  data[activeCategory].forEach((row, i) => {
    const tr = document.createElement("tr");

    if (row.type === "header") {
      tr.className = "header-row";
      const td = document.createElement("td");
      td.colSpan = 7;
      const span = document.createElement("span");
      span.contentEditable = true;
      span.textContent = row.text || "Section / Header";
      span.oninput = () => {
        row.text = span.textContent;
        save();
      };
      td.appendChild(span);
      tr.appendChild(td);

      const del = document.createElement("td");
      del.style.textAlign = "center";
      del.innerHTML = `<span class="delete-button" onclick="deleteRow(${i})" style="cursor:pointer;">üóëÔ∏è</span>`;

      tr.appendChild(del);
      tbody.appendChild(tr);
      return;
    }

    const fields = ['product', 'start', 'used', 'end', 'min', 'comment', 'order'];
    const inputs = {};

    fields.forEach((key) => {
      const td = document.createElement("td");
      
      if (key === "product") td.classList.add("cell-product");
      else if (key === "comment") td.classList.add("cell-comment");
      else if (key === "min") td.classList.add("cell-min");
      else if (key === "order") td.classList.add("cell-order");
      else td.classList.add("cell-small");


      const input = document.createElement("input");
      input.type = key === "product" || key === "comment" ? "text" : "number";
      input.value = row[key] || "";
      input.style.width = "90%";
      input.style.padding = "5px";
      input.style.borderRadius = "5px";
      input.placeholder = key.charAt(0).toUpperCase() + key.slice(1);
      if (["product", "comment", "start", "used", "end", "min", "order"].includes(key)) {
     input.classList.add("large-bold-input");
     }


      input.oninput = () => {
        row[key] = input.value;

        row.end = (parseFloat(row.start) || 0) - (parseFloat(row.used) || 0);
        inputs['end'].value = row.end;

        const endVal = parseFloat(row.end);
        const minVal = parseFloat(row.min);
        if (!isNaN(endVal) && !isNaN(minVal) && endVal <= minVal) {
          inputs['min'].classList.add("red-warning");
        } else {
          inputs['min'].classList.remove("red-warning");
        }

        save();
      };
      inputs[key] = input;
      td.appendChild(input);
      tr.appendChild(td);
    });

    const tdDel = document.createElement("td");
    tdDel.innerHTML = `<span class="delete-button" onclick="deleteRow(${i})">üóëÔ∏è</span>`
    
    tr.appendChild(tdDel);
    tbody.appendChild(tr);
  });

  content.appendChild(table);

  const addLine = document.createElement("button");
  addLine.className = "add-line";
  addLine.textContent = "+ Add line";
  addLine.onclick = () => {
    data[activeCategory].push({
      type: "line", product: "", start: 0, used: 0,
      comment: "", min: 0, order: 0, end: 0
    });
    save();
    showCategory();
  };

  const addHeader = document.createElement("button");
  addHeader.className = "add-line";
  addHeader.textContent = "+ Add header/section";
  addHeader.onclick = () => {
    data[activeCategory].push({ type: "header", text: "New Header" });
    save();
    showCategory();
  };

  content.appendChild(addLine);
  content.appendChild(addHeader);
  searchInPage(); // kj√∏r s√∏ket igjen etter innhold er bygd opp

}

function deleteRow(index) {
  data[activeCategory].splice(index, 1);
  save();
  showCategory();
}

function showGlobalOverview() {
  const content = document.getElementById("content");
  content.innerHTML = "<h2>Global overview of the entire inventory</h2>";
  const table = document.createElement("table");
  table.innerHTML = `
    <thead>
      <tr><th>Category</th><th>Product</th><th>Start</th><th>Used</th><th>End</th><th>Min</th><th>Comment</th><th>Order</th></tr>
    </thead>
    <tbody></tbody>
  `;
  const tbody = table.querySelector("tbody");

  Object.entries(data).forEach(([category, rows]) => {
    rows.forEach(row => {
      if (row.type === "header") return;
      const tr = document.createElement("tr");
      const start = parseInt(row.start) || 0;
      const used = parseInt(row.used) || 0;
      const end = row.end ?? (start - used);
      const min = parseInt(row.min) || 0;

      const values = [
        category,
        row.product || "",
        start,
        used,
        end,
        min,
        row.comment || "",
        row.order || ""
      ];

      values.forEach((val, i) => {
        const td = document.createElement("td");
        td.textContent = val;
        if (i === 4 && end <= min) td.classList.add("red-warning");
        tr.appendChild(td);
      });

      tbody.appendChild(tr);
    });
  });

  content.appendChild(table);
}

if (!data[activeCategory]) {
  data[activeCategory] = [];
  save();
}
updateCategories();
showCategory();


</script>
</body>
</html>
