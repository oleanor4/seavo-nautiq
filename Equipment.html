<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Equipment â€“ Seavo Nautiq</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  
  <!-- Only load files that exist -->
  <link rel="stylesheet" href="css/inventory-styles.css">
  <script src="./js/seavo-core.js" defer></script>
  <script src="./js/table-module.js" defer></script>
  <!-- Remove responsive.css and responsive.js for now -->
  <!-- Remove js/MODAL.js if it doesn't exist -->
</head>

<body>
  <header class="video-header">
  </header>
  <div class="gradient-overgang"></div>

  <!-- Libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.19.3/xlsx.full.min.js"></script>

  <input type="text" id="searchBox" placeholder="Search inventory..." oninput="searchInPage()">

  <div class="category-slider-office"></div>

  <div><img src="images/Equipment.PNG" alt="Equipment" class="equipment"></div>

  <!-- Table padding slider -->
  <label for="padding-slider" style="display:block;text-align:center;margin:10px 0;color:rgb(28, 192, 233);">
    Table Padding
  </label>
  <input id="padding-slider" type="range" min="0" max="12" value="0" />

  <div id="content"></div>

  <!-- Action buttons -->
  <button class="global-button" onclick="window.tableInstance.addRow()">+ Add Row</button>
  <button class="global-button" onclick="window.tableInstance.addHeader()">+ Add Section Header</button>
  <button id="globalToggleButton" class="global-button" onclick="window.tableInstance.toggleGlobalView()">ðŸ“‹ Global Overview</button>
  <button class="global-button" onclick="window.tableInstance.generatePDF()">ðŸ“„ Generate PDF</button>
  <button class="global-button" onclick="window.tableInstance.generateExcel()">ðŸ“Š Export to Excel</button>
  <button class="global-button" onclick="window.tableInstance.save()">ðŸ’¾ Save</button>

  <!-- Side Panel -->
  <div id="sidePanel">
    <button id="togglePanelBtn" onclick="toggleSidePanel()">â˜°</button>
  </div>

  <!-- Theme Slider -->
  <div class="theme-slider-container">
    <label for="themeSlider">Theme:</label>
    <input type="range" id="themeSlider" min="5" max="95" value="20">
  </div>

  <script>
    // Search functionality
    function searchInPage() {
      const searchTerm = document.getElementById('searchBox').value.toLowerCase();
      const table = document.querySelector('#content table');
      if (!table) return;

      const rows = table.querySelectorAll('tbody tr');
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(searchTerm) ? '' : 'none';
      });
    }

    // Side panel toggle
    function toggleSidePanel() {
      document.getElementById('sidePanel').classList.toggle('hidden');
    }

    // Padding slider
    const slider = document.getElementById("padding-slider");
    const STORAGE_KEY = "tableCellPadding";
    const savedPadding = localStorage.getItem(STORAGE_KEY) || 0;
    slider.value = savedPadding;
    document.documentElement.style.setProperty("--cell-padding", savedPadding + "px");

    slider.addEventListener("input", e => {
      const value = e.target.value;
      document.documentElement.style.setProperty("--cell-padding", value + "px");
      localStorage.setItem(STORAGE_KEY, value);
    });

    // Theme slider
    const themeSlider = document.getElementById('themeSlider');
    themeSlider.addEventListener('input', (e) => {
      const lightness = e.target.value;
      document.documentElement.style.setProperty('--bg-lightness', lightness + '%');
    });

    // Debug and initialize
    document.addEventListener('DOMContentLoaded', () => {
      console.log('DOM loaded');
      console.log('TABLE_CONFIGS:', typeof TABLE_CONFIGS !== 'undefined' ? 'Found' : 'Missing');
      console.log('InventoryTable:', typeof InventoryTable !== 'undefined' ? 'Found' : 'Missing');
      
      if (typeof TABLE_CONFIGS !== 'undefined' && typeof InventoryTable !== 'undefined') {
        console.log('Creating table instance...');
        window.tableInstance = new InventoryTable(TABLE_CONFIGS.equipment);
        console.log('Table instance created, initializing...');
        window.tableInstance.init();
        console.log('Table initialized');
      } else {
        console.error('Missing dependencies!');
      }
    });
  </script>
</body>
</html>